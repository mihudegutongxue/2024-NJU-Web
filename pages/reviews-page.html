<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="VANNO - Premium directory consumer reviews and listings template by Ansonika">
    <meta name="author" content="Ansonika">
    <title>趣分享</title>

    <!-- GOOGLE WEB FONT -->
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700" rel="stylesheet">

	<!-- BASE CSS -->
	<link href="../css/bootstrap.min.css" rel="stylesheet">
	<link href="../css/style.css" rel="stylesheet">
	<link href="../css/vendors.css" rel="stylesheet">
	
	<!-- YOUR CUSTOM CSS -->
	<link href="../css/custom.css" rel="stylesheet">

</head>

<body>

	<script src="../js/bootstrap.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
	
	<div id="page">
		
	<header class="header_in">
		<div class="container">
			<div class="row">
				<div class="col-lg-3 col-12">
					<div id="logo">
						<a href="classification.html">
							<h5>趣分享 · 兴趣圈分享平台</h5>
						</a>
					</div>
				</div>
				<div class="col-lg-9 col-12">
					<ul id="top_menu">
						<li><a href="write-review.html" class="btn_top">撰写评论</a></li>
						<li><a href="#" class="btn_top company" id="back_to">Back！</a></li>
					</ul>
					<!-- /top_menu -->
					<a href="#menu" class="btn_mobile">
						<div class="hamburger hamburger--spin" id="hamburger">
							<div class="hamburger-box">
								<div class="hamburger-inner"></div>
							</div>
						</div>
					</a>
				</div>
			</div>
			<!-- /row -->
		</div>
		<!-- /container -->
	</header>
	<!-- /header -->
	
	<main>
		<div id="results">
			<div class="container">
				<div class="row justify-content-between">
					<div class="col-lg-3 col-md-4 col-10">
						<h1>共有<strong id="count_it">145</strong>个评论</h1>
					</div>
				</div>
			</div>
			<!-- /container -->
		</div>
		<!-- /results -->
	
		
		<div class="container margin_60_35">
			<div class="row">
				<div class="col-lg-8">
					<div class="review_card" style="width: 1100px;">
						<div class="row">
							<div class="col-md-2 user_info">
								<b style="font-size: 25px;" id="user">username</b>
							</div>
							<div class="col-md-10 review_content">
								<div class="clearfix add_bottom_15">
									<em id="publish">Published: 2018-8-12</em>
								</div>
								<h4 id="title">标题</h4>
								<p id="content">Eos tollit ancillae ea, lorem consulatu qui ne, eu eros eirmod scaevola sea. Et nec tantas accusamus salutatus, sit commodo veritus te, erat legere fabulas has ut. Rebum laudem cum ea, ius essent fuisset ut. Viderer petentium cu his. Tollit molestie suscipiantur his et.</p>
								<ul class="clearfix">
									<li><a href="#" class="btn_1 small" id="comment">comment</a></li>
								</ul>
							</div>
						</div>
						<!-- /row -->
						<div class="row reply">
							<div class="col-md-2 user_info">
								<figure><img src="img/avatar.jpg" alt=""></figure>
							</div>
							<div class="col-md-10">
								<div class="review_content" id="cluster">

								</div>
							</div>
						</div>
						<!-- /reply -->
					</div>
				</div>
			</div>
			<!-- /row -->
		</div>
		<!-- /container -->
		
	</main>
	<!--/main-->
	<button type="button" class="btn btn-primary brief-button" style="display: none;" data-bs-toggle="modal"
		data-bs-target=".my-box">
	</button>

	<div class="modal my-box" tabindex="-1">
		<div class="modal-dialog">
			<!-- 弹框内容 -->
			<div class="modal-content">
				<!-- 弹框头部 -->
				<div class="modal-header">
					<h2 class="modal-title">Comment</h2>
				</div>
				<!-- 弹框身体 -->
				<div class="modal-body">
					<textarea style="width: 460px;" id="my_comment"></textarea>
				</div>
				<!-- 弹框底部 -->
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal" id="close">关闭</button>
					<button type="button" class="btn btn-primary" id="fabu">发布评论</button>
				</div>
			</div>
		</div>
	</div>
	
	<footer>
		<div class="container">
			<div class="row">
				<div class="col-lg-3 col-md-6 col-sm-6">
					<a data-toggle="collapse" data-target="#collapse_ft_1" aria-expanded="false"
						aria-controls="collapse_ft_1" class="collapse_bt_mobile">
						<h3>Quick Links</h3>
						<div class="circle-plus closed">
							<div class="horizontal"></div>
							<div class="vertical"></div>
						</div>
					</a>
					<div class="collapse show" id="collapse_ft_1">
						<ul class="links">
							<li><a href="../index.html">首页</a></li>
							<li><a href="./userinfo.html">个人信息</a></li>
							<li><a href="./user-dashboard.html">个人帖子</a></li>
							<li><a href="./activity.html">活跃情况</a></li>
						</ul>
					</div>
				</div>
				<div class="col-lg-3 col-md-6 col-sm-6">
					<a data-toggle="collapse" data-target="#collapse_ft_2" aria-expanded="false"
						aria-controls="collapse_ft_2" class="collapse_bt_mobile">
						<h3>Categories</h3>
						<div class="circle-plus closed">
							<div class="horizontal"></div>
							<div class="vertical"></div>
						</div>
					</a>
					<div class="collapse show" id="collapse_ft_2">
						<ul class="links">
							<li><a href="#0">艺术与文化</a></li>
							<li><a href="#0">旅行与探险</a></li>
							<li><a href="#0">美食与烹饪</a></li>
							<li><a href="#0">健康与运动</a></li>
							<li><a href="#0">科技与编程</a></li>
							<li><a href="#0">时尚与美容</a></li>
						</ul>
					</div>
				</div>
				<div class="col-lg-3 col-md-6 col-sm-6">
					<a data-toggle="collapse" data-target="#collapse_ft_3" aria-expanded="false"
						aria-controls="collapse_ft_3" class="collapse_bt_mobile">
						<h3>Contacts</h3>
						<div class="circle-plus closed">
							<div class="horizontal"></div>
							<div class="vertical"></div>
						</div>
					</a>
					<div class="collapse show" id="collapse_ft_3">
						<ul class="contacts">
							<li><i class="ti-email"></i><a href="#0">728850979@qq.com</a></li>
						</ul>
					</div>
				</div>
				<div class="col-lg-3 col-md-6 col-sm-6">
					<a data-toggle="collapse" data-target="#collapse_ft_4" aria-expanded="false"
						aria-controls="collapse_ft_4" class="collapse_bt_mobile">
						<div class="circle-plus closed">
							<div class="horizontal"></div>
							<div class="vertical"></div>
						</div>
						<h3>Have Fun ! </h3>
					</a>
				</div>
			</div>
			<!-- /row-->
			<hr>
			<div class="row">
				<div class="col-lg-6">
				</div>
				<div class="col-lg-6">
					<ul id="additional_links">
						<li><a href="#0">Terms and conditions</a></li>
						<li><a href="#0">Privacy</a></li>
						<li><span>© 2024 趣分享</span></li>
					</ul>
				</div>
			</div>
		</div>
	</footer>
	<!--/footer-->
	</div>
	<!-- page -->
	
	<script>
		const cluster = document.getElementById('cluster')
		const token = localStorage.getItem('token')
		const Id = localStorage.getItem('Id')
		const count_it = document.getElementById('count_it')

		axios({
			url: 'http://127.0.0.1:3007/my/article/showComment',
			method: 'POST',
			headers: {
				'Content-Type': 'application/x-www-form-urlencoded',
				'Authorization': token
			},
			data: {
				Id,
			}
		}).then(result => {
			var comments = result.data.data[0].comment
			if(!comments){
				count_it.innerHTML = 0
			}else{
				var show_it = comments.split('&&&')
				count_it.innerHTML = show_it.length
				cluster.innerHTML = `<strong> Comments</strong>`
				for (let i = 0; i < show_it.length; i++) {
					cluster.innerHTML += `<p><br>${show_it[i]}</p>`
				}
			}
		})

		const back_to = document.getElementById('back_to')

		back_to.addEventListener('click',()=>{
			history.back()
		})

		
		const user = document.getElementById('user')
		const publish = document.getElementById('publish')
		const title = document.getElementById('title')
		const content = document.getElementById('content')
		

		axios({
				url: 'http://127.0.0.1:3007/my/article/getArticleById',
				method: 'POST',
				headers: {
					'Content-Type': 'application/x-www-form-urlencoded',
					'Authorization': token
				},
				data: {
					Id
				}
			}).then(result => {
				user.innerHTML = result.data.data[0].username
				publish.innerHTML = "Published: "+ result.data.data[0].pub_date
				title.innerHTML = result.data.data[0].title
				content.innerHTML = result.data.data[0].content
			})

		document.querySelector('#comment').addEventListener('click', function (event) {
				event.preventDefault(); // 阻止默认行为
				document.querySelector('.brief-button').click();
			})

		const my_comment = document.getElementById('my_comment')
		const fabu = document.getElementById('fabu')
		
		
		fabu.addEventListener('click', () => {
			const pinglun = my_comment.value
			console.log(pinglun)
			if (pinglun === '') {
				alert('亲，您的内容为空，无法发布')
			} else {
				my_comment.value = ''
				document.querySelector('#close').click();
				alert('发布成功！')
				axios({
					url: 'http://127.0.0.1:3007/my/article/modifyComment',
					method: 'POST',
					headers: {
						'Content-Type': 'application/x-www-form-urlencoded',
						'Authorization': token
					},
					data: {
						Id,
						comment: pinglun
					}
				}).then(result => {})

				window.location.reload();
			}

		})
		

		


	</script>
	
	<div id="toTop"></div><!-- Back to top button -->
	
	<!-- COMMON SCRIPTS -->
    <script src="../js/common_scripts.js"></script>
	<script src="../js/functions.js"></script>
	<!-- <script src="assets/validate.js"></script> -->

</body>
</html>