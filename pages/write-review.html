<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="VANNO - Premium directory consumer reviews and listings template by Ansonika">
    <meta name="author" content="Ansonika">
    <title>趣分享</title>

    <!-- GOOGLE WEB FONT -->
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700" rel="stylesheet">

    <!-- BASE CSS -->
    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/style.css" rel="stylesheet">
	<link href="../css/vendors.css" rel="stylesheet">

    <!-- YOUR CUSTOM CSS -->
    <link href="../css/custom.css" rel="stylesheet">

</head>

<body>

	<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
	
	<div id="page">
	<header class="header_in is_fixed menu_fixed">
		<div class="container">
			<div class="row">
				<div class="col-lg-3 col-12">
					<div id="logo">
						<a href="classification.html">
							<h5>趣分享 · 兴趣圈分享平台</h5>
						</a>
					</div>
				</div>
				<div class="col-lg-9 col-12">
					<ul id="top_menu">
						<li><a href="../index.html" class="btn_top company">Back！</a></li>
					</ul>
					<!-- /top_menu -->
					<a href="#menu" class="btn_mobile">
						<div class="hamburger hamburger--spin" id="hamburger">
							<div class="hamburger-box">
								<div class="hamburger-inner"></div>
							</div>
						</div>
					</a>
				</div>
			</div>
			<!-- /row -->
		</div>
		<!-- /container -->		
	</header>
	<!-- /header -->
	
	<main class="margin_main_container">
		<div class="container margin_60_35">
			<div class="row">
				<div class="col-lg-8">
					<div class="box_general write_review">
						<h1>请撰写您的帖子</h1>
						<div class="form-group">
							<label>帖子标题</label>
							<input class="form-control" type="text" placeholder="If you could say it in one sentence, what would you say?" id="title">
						</div>
						<label>帖子分类</label>
						<select id="classification">
							<option value="option1">艺术与文化</option>
							<option value="option2">旅行与探险</option>
							<option value="option3">美食与烹饪</option>
							<option value="option4">健康与运动</option>
							<option value="option5">科技与编程</option>
							<option value="option6">时尚与美容</option>
						</select>
						<div class="form-group">
							<label>帖子内容</label>
							<textarea class="form-control" style="height: 180px;" placeholder="Write your review to help others learn about you" id="content"></textarea>
						</div>
						<div class="form-group">
							<label>添加照片 (可选)</label>
							<div class="fileupload"><input type="file" name="fileupload" accept="image/*"></div>
						</div>
						<div class="form-group">
							<div class="checkboxes float-left add_bottom_15 add_top_15">
							</div>
						</div>
						<a href="#" class="btn_1" id="submit">提交帖子</a>
					</div>
				</div>
				<!-- /col -->
				<div class="col-lg-4" >
					<h4>您的最近帖子</h4>
					<div class="latest_review" id="cluster">
						
						<!-- /review_listing -->
					</div>
					<!-- /latest_review -->
					
				</div>
			</div>
			<!-- /row -->
		</div>
		<!-- /container -->
	</main>
	<!--/main-->
	
	<footer>
		<div class="container">
			<div class="row">
				<div class="col-lg-3 col-md-6 col-sm-6">
					<a data-toggle="collapse" data-target="#collapse_ft_1" aria-expanded="false"
						aria-controls="collapse_ft_1" class="collapse_bt_mobile">
						<h3>Quick Links</h3>
						<div class="circle-plus closed">
							<div class="horizontal"></div>
							<div class="vertical"></div>
						</div>
					</a>
					<div class="collapse show" id="collapse_ft_1">
						<ul class="links">
							<li><a href="../index.html">首页</a></li>
							<li><a href="./userinfo.html">个人信息</a></li>
							<li><a href="./user-dashboard.html">个人帖子</a></li>
							<li><a href="./activity.html">活跃情况</a></li>
						</ul>
					</div>
				</div>
				<div class="col-lg-3 col-md-6 col-sm-6">
					<a data-toggle="collapse" data-target="#collapse_ft_2" aria-expanded="false"
						aria-controls="collapse_ft_2" class="collapse_bt_mobile">
						<h3>Categories</h3>
						<div class="circle-plus closed">
							<div class="horizontal"></div>
							<div class="vertical"></div>
						</div>
					</a>
					<div class="collapse show" id="collapse_ft_2">
						<ul class="links">
							<li><a href="#0">艺术与文化</a></li>
							<li><a href="#0">旅行与探险</a></li>
							<li><a href="#0">美食与烹饪</a></li>
							<li><a href="#0">健康与运动</a></li>
							<li><a href="#0">科技与编程</a></li>
							<li><a href="#0">时尚与美容</a></li>
						</ul>
					</div>
				</div>
				<div class="col-lg-3 col-md-6 col-sm-6">
					<a data-toggle="collapse" data-target="#collapse_ft_3" aria-expanded="false"
						aria-controls="collapse_ft_3" class="collapse_bt_mobile">
						<h3>Contacts</h3>
						<div class="circle-plus closed">
							<div class="horizontal"></div>
							<div class="vertical"></div>
						</div>
					</a>
					<div class="collapse show" id="collapse_ft_3">
						<ul class="contacts">
							<li><i class="ti-email"></i><a href="#0">728850979@qq.com</a></li>
						</ul>
					</div>
				</div>
				<div class="col-lg-3 col-md-6 col-sm-6">
					<a data-toggle="collapse" data-target="#collapse_ft_4" aria-expanded="false"
						aria-controls="collapse_ft_4" class="collapse_bt_mobile">
						<div class="circle-plus closed">
							<div class="horizontal"></div>
							<div class="vertical"></div>
						</div>
						<h3>Have Fun ! </h3>
					</a>
				</div>
			</div>
			<!-- /row-->
			<hr>
			<div class="row">
				<div class="col-lg-6">
				</div>
				<div class="col-lg-6">
					<ul id="additional_links">
						<li><a href="#0">Terms and conditions</a></li>
						<li><a href="#0">Privacy</a></li>
						<li><span>© 2024 趣分享</span></li>
					</ul>
				</div>
			</div>
		</div>
	</footer>
	<!--/footer-->
	</div>
	<!-- page -->

	<script>
		
		const token = localStorage.getItem('token')
		const username = localStorage.getItem('username')
		const submit = document.getElementById('submit')
		const cluster = document.getElementById('cluster')
		var real_classification = ''


		const now = new Date();
		const year = now.getFullYear();
		const month = String(now.getMonth() + 1).padStart(2, '0'); // 月份从0开始，所以需要加1
		const day = String(now.getDate()).padStart(2, '0');
		const pub_date = `${year}-${month}-${day}`

		submit.addEventListener('click',()=>{
			const title = document.getElementById('title').value.trim()
			const classification = document.getElementById('classification').value
			const content = document.getElementById('content').value.trim()
			if (classification === 'option1') {
				real_classification = '艺术与文化'
			} else if (classification === 'option2') {
				real_classification = '旅行与探险'
			} else if (classification === 'option3') {
				real_classification = '美食与烹饪'
			} else if (classification === 'option4') {
				real_classification = '健康与运动'
			} else if (classification === 'option5') {
				real_classification = '科技与编程'
			} else if (classification === 'option6') {
				real_classification = '时尚与美容'
			}
			if (title === '') {
				alert('标题不能为空')
			}else if (content === '') {
				alert('内容不能为空')
			}else{
				const now = new Date();
				const year = now.getFullYear();
				const month = String(now.getMonth() + 1).padStart(2, '0'); // 月份从0开始，所以需要加1
				const day = String(now.getDate()).padStart(2, '0');
				const pub_date = `${year}-${month}-${day}`
				axios({
					url: 'http://127.0.0.1:3007/my/article/addArticle',
					method: 'POST',
					headers: {
						'Content-Type': 'application/x-www-form-urlencoded',
						'Authorization': token
					},
					data: {
						title,
						content,
						username,
						leibie: real_classification,
						pub_date
					}
				}).then(result => {
					document.getElementById('title').value = ''
					document.getElementById('classification').value = 'option1'
					document.getElementById('content').value = ''
					location.href = 'confirm.html'
				})
			}
			
		})

		axios({
				url: 'http://127.0.0.1:3007/my/article/getTotal',
				method: 'POST',
				headers: {
					'Content-Type': 'application/x-www-form-urlencoded',
					'Authorization': token
				},
				data: {
					username: localStorage.getItem('username')
				}
			}).then(result => {
				for (let i = result.data.data.length-1; i > result.data.data.length-3; i--) {
					cluster.innerHTML += `<div class="review_listing">
							<div class="clearfix add_bottom_10">
								<b style="font-size: 19px;">${result.data.data[i].username}</b>
								<small>${result.data.data[i].leibie}</small>
							</div>
							<h4>${result.data.data[i].title}</h4>
							<p>${result.data.data[i].content}</p>
							<ul class="clearfix">
								<li><a href="reviews-page.html" class="btn_1 small">Read review</a></li>
							</ul>
						</div>`
				}
			})
	</script>
	
	
	<div id="toTop"></div><!-- Back to top button -->
	
	<!-- COMMON SCRIPTS -->
    <script src="../js/common_scripts.js"></script>
	<script src="../js/functions.js"></script>
	<!-- <script src="assets/validate.js"></script> -->

</body>
</html>